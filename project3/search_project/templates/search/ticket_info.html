                            <table class="uk-table">
                            {% if view_display%}
                            {% if view_list %}
                                <thead>
                                    <tr>
                                        <th>车号</th>
                                        <th>起始站</th>
                                        <th>目的站</th>
                                        <th>开车时间</th>
                                        <th>抵达时间</th>
                                        <th>总共时长</th>
                                        <th>商务座</th>
                                        <th>一等座</th>
                                        <th>二等座</th>
                                        <th>高级软卧</th>
                                        <th>软卧</th>
                                        <th>动卧</th>
                                        <th>硬卧</th>
                                        <th>软座</th>
                                        <th>硬座</th>
                                        <th>无座</th>
                                    </tr>
                                </thead>
                                {% for ticket_info in view_list %}
                                <tbody>
                                    <tr>
                                        <td>
                                            <span data-uk-tooltip title="车号:{{ ticket_info.train_num }}">{{ ticket_info.train_num }}</span>
                                            <a id="{{ ticket_info.train_num}}"><i class="uk-icon-bars"></i></a>
                                        </td>
                                        <td>
                                            <span data-uk-tooltip title="起始站:{{ ticket_info.f_station }} | 起点站:{{ ticket_info.q_station }}">{{ ticket_info.f_station }}</span>
                                        </td>
                                        <td>
                                            <span data-uk-tooltip title="目的站:{{ ticket_info.t_station }} | 终点站:{{ ticket_info.z_station }}">{{ ticket_info.t_station }}</span>
                                        </td>
                                        <td>
                                            <span data-uk-tooltip title="开车时间:{{ ticket_info.from_time }}">{{ ticket_info.from_time }}</span>
                                        </td>
                                        <td>
                                            <span data-uk-tooltip title="抵达时间:{{ ticket_info.to_time }}">{{ ticket_info.to_time }}</span>
                                        </td>
                                        <td>
                                            <span data-uk-tooltip title="总共时长:{{ ticket_info.all_time }}">{{ ticket_info.all_time }}</span>
                                        </td>
                                        <td>
                                            <span data-uk-tooltip title="商务座:{{ ticket_info.price.A9 }}">{{ ticket_info.swz_num }}</span>
                                        </td>
                                        <td>
                                            <span data-uk-tooltip title="一等座:{{ ticket_info.price.M }}">{{ ticket_info.ydz_num }}</span>
                                        </td>
                                        <td >
                                            <span data-uk-tooltip title="二等座:{{ ticket_info.price.O }}">{{ ticket_info.edz_num }}</span>
                                        </td>
                                        <td>
                                            <span data-uk-tooltip title="高级软卧:{{ ticket_info.price.A9 }}">{{ ticket_info.gjrw_num }}</span>
                                        </td>
                                        <td>
                                            <span data-uk-tooltip title="软卧:{{ ticket_info.price.A4 }}">{{ ticket_info.rw_num }}</span>
                                        </td>
                                        <td>
                                            <span data-uk-tooltip title="动卧:{{ ticket_info.price.F }}">{{ ticket_info.dw_num }}</span>
                                        </td>
                                        <td>
                                            <span data-uk-tooltip title="硬卧:{{ ticket_info.price.A3 }}">{{ ticket_info.yw_num }}</span>
                                        </td>
                                        <td>
                                            <span data-uk-tooltip title="软座:{{ ticket_info.price.A2 }}">{{ ticket_info.rz_num }}</span>
                                        </td>
                                        <td>
                                            <span data-uk-tooltip title="硬座:{{ ticket_info.price.A1 }}">{{ ticket_info.yz_num }}</span>
                                        </td>
                                        <td>
                                            <span data-uk-tooltip title="无座:{{ ticket_info.price.WZ }}">{{ ticket_info.wz_num }}</span>
                                        </td>
                                    </tr>
                                </tbody>
                                {% empty %}
                                {% endfor %}
                            {% else %}
                            <div class="uk-alert" data-uk-alert>
                                <a href="" class="uk-alert-close uk-close"></a>
                                <p>该日期没有班次了</p>
                            </div> 
                            {% endif %}
                            {% endif %}
                            </table>
                            {% if error_msg %}
                            <div class="uk-alert" data-uk-alert>
                                <a href="" class="uk-alert-close uk-close"></a>
                                <p>{{ error_msg }}</p>
                            </div> 
                            {% endif %}

<script> 
    /*引用api
    $(document).ready(function(){  
    {% for ticket_info in view_list %}
    $('#{{ ticket_info.train_num }}').click(function(e){  
            var train_num = "{{ ticket_info.train_num }}"; 
            var info = new Set();
            var html_resultinfo = " "
            //边框定位
            var pageX = e.pageX+20,
                pageY = e.pageY-150;
            var abc = document.body.clientHeight;
            if (pageY>abc*0.5){
                $('#train_display').css({
                    left: pageX,
                    top: abc*0.5
                }); 
            }
            else{
                $('#train_display').css({
                    top: pageY,
                    left: pageX
                });  
            }
            url = train_num;
            train_display.style.display="block";
            $.getJSON(url,function(ret,result){
                if (ret.retCode == 200){
                    a = ret.result
                    start = ret.result[0].startStationName
                    end = ret.result[0].endStationName
                    document.getElementById('train_no').innerHTML = train_num;
                    document.getElementById('train_start').innerHTML = start;
                    document.getElementById('train_end').innerHTML = end;
                    $.each(a, function(i,item){
                        html_resultinfo += '<tr><td>' + a[i].arriveTime + '</td>' +
                                '<td>' + a[i].startTime + '</td>' +
                                '<td>' + a[i].stationName + '</td>' +
                                '<td>' + a[i].stopoverTime + '</td>' +
                                '</tr>';
                    });
                    document.getElementById('ticket-tbody').innerHTML =html_resultinfo;
                }
                else{
                    document.getElementById('train_no').innerHTML = train_num;
                    document.getElementById('train_start').innerHTML = "";
                    document.getElementById('train_end').innerHTML = "";
                    document.getElementById('ticket-tbody').innerHTML = "暂无该列车信息"
                }
            });    
            return false;  
        });  
    {% empty %}
    {% endfor %}
    });
    */
    $(document).ready(function(){  
    {% for ticket_info in view_list %}
    $('#{{ ticket_info.train_num }}').click(function(e){  
            var train_num = "{{ ticket_info.train_num }}"; 
            var info = new Set();
            var html_resultinfo = " "
            var time = $("#time").val(); 
            var train_no = "{{ ticket_info.train_no }}"
            var t_station = "{{ ticket_info.from_station }}"
            var f_station = "{{ ticket_info.to_station }}"
            //边框定位
            var pageX = e.pageX+20,
                pageY = e.pageY-150;
            var abc = document.body.clientHeight;
            if (pageY>abc*0.5){
                $('#train_display').css({
                    left: pageX,
                    top: abc*0.5
                }); 
            }
            else{
                $('#train_display').css({
                    top: pageY,
                    left: pageX
                });  
            }
            url = "time/"+time.split('-')[0]+"_"+time.split('-')[1]+"_"+time.split('-')[2]+"_"+train_no+"_"+f_station+"_"+t_station
            train_display.style.display="block";
            $.getJSON(url,function(ret,result){
                if (ret.httpstatus == 200){
                    a = ret.data.data
                    document.getElementById('train_no').innerHTML = train_num;
                    document.getElementById('train_start').innerHTML = "{{ ticket_info.f_station }}";
                    document.getElementById('train_end').innerHTML = "{{ ticket_info.t_station }}";
                    $.each(a, function(i,item){
                        html_resultinfo += '<tr><td>' + a[i].arrive_time + '</td>' +
                                '<td>' + a[i].start_time + '</td>' +
                                '<td>' + a[i].station_name + '</td>' +
                                '<td>' + a[i].stopover_time + '</td>' +
                                '</tr>';
                    });
                    document.getElementById('ticket-tbody').innerHTML =html_resultinfo;
                }
                else{
                    document.getElementById('train_no').innerHTML = train_num;
                    document.getElementById('train_start').innerHTML = "";
                    document.getElementById('train_end').innerHTML = "";
                    document.getElementById('ticket-tbody').innerHTML = "暂无该列车信息"
                }
            });    
            return false;  
        });  
    {% empty %}
    {% endfor %}
    });
</script>